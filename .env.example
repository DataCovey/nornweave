# =============================================================================
# NornWeave Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# Never commit .env to version control!

# -----------------------------------------------------------------------------
# Storage Configuration (Ur√∞r - The Well)
# -----------------------------------------------------------------------------
# Database driver: sqlite | postgres
DB_DRIVER=sqlite

# SQLite path (default, good for development and quickstart)
# Leave empty to use the default: ./nornweave.db
# DATABASE_URL=sqlite+aiosqlite:///./nornweave.db

# PostgreSQL connection string (production)
# DB_DRIVER=postgres
# DATABASE_URL=postgresql+asyncpg://nornweave:nornweave@localhost:5432/nornweave

# -----------------------------------------------------------------------------
# Email Provider Configuration (Yggdrasil - Provider Adapters)
# -----------------------------------------------------------------------------
# Provider: mailgun | ses | sendgrid | resend | imap-smtp
EMAIL_PROVIDER=mailgun

# Domain used to construct inbox email addresses (e.g. support@EMAIL_DOMAIN).
# Set this to the domain your provider uses for sending and receiving.
EMAIL_DOMAIN=mail.example.com

# Mailgun Configuration
MAILGUN_API_KEY=
MAILGUN_DOMAIN=

# AWS SES Configuration
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# SendGrid Configuration
SENDGRID_API_KEY=

# Resend Configuration
RESEND_API_KEY=
RESEND_WEBHOOK_SECRET=

# IMAP/SMTP Configuration (used when EMAIL_PROVIDER=imap-smtp)
# SMTP (outbound)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USERNAME=
# SMTP_PASSWORD=
# SMTP_USE_TLS=true
# IMAP (inbound polling)
# IMAP_HOST=imap.example.com
# IMAP_PORT=993
# IMAP_USERNAME=
# IMAP_PASSWORD=
# IMAP_USE_SSL=true
# IMAP_POLL_INTERVAL=60
# IMAP_MAILBOX=INBOX
# IMAP_MARK_AS_READ=true
# IMAP_DELETE_AFTER_FETCH=false

# -----------------------------------------------------------------------------
# API Security (Yggdrasil - Gateway)
# -----------------------------------------------------------------------------
# API key for authenticating requests (generate a secure random string)
API_KEY=

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# Host and port for the API server
HOST=0.0.0.0
PORT=8000

# Environment: development | staging | production
ENVIRONMENT=development

# Log level: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Attachment Storage Configuration
# -----------------------------------------------------------------------------
# Storage backend: local | database | s3 | gcs
ATTACHMENT_STORAGE_BACKEND=local

# Local filesystem storage path (for local backend)
ATTACHMENT_LOCAL_PATH=./data/attachments

# URL prefix for attachment downloads
# ATTACHMENT_SERVE_URL_PREFIX=/v1/attachments

# Signed URL expiry time (seconds)
ATTACHMENT_URL_EXPIRY_SECONDS=3600

# Attachment size limits
# ATTACHMENT_MAX_SIZE_MB=25
# ATTACHMENT_MAX_TOTAL_SIZE_MB=35
# ATTACHMENT_MAX_COUNT=20

# S3 Storage Configuration (requires nornweave[s3])
# ATTACHMENT_S3_BUCKET=nornweave-attachments
# ATTACHMENT_S3_PREFIX=attachments
# ATTACHMENT_S3_REGION=us-east-1
# ATTACHMENT_S3_ACCESS_KEY=
# ATTACHMENT_S3_SECRET_KEY=
# Optional: S3-compatible endpoint (MinIO, DigitalOcean Spaces, etc.)
# AWS_S3_ENDPOINT_URL=http://localhost:9000

# GCS Storage Configuration (requires nornweave[gcs])
# ATTACHMENT_GCS_BUCKET=nornweave-attachments
# ATTACHMENT_GCS_PREFIX=attachments
# Optional: explicit credentials path (uses ADC if not set)
# ATTACHMENT_GCS_CREDENTIALS_PATH=/path/to/credentials.json

# -----------------------------------------------------------------------------
# LLM Thread Summarization (Verdandi - The Loom)
# -----------------------------------------------------------------------------
# Enable automatic thread summaries by setting a provider and API key.
# Disabled by default (LLM_PROVIDER not set).

# Provider: openai | anthropic | gemini (leave empty to disable)
# LLM_PROVIDER=openai

# API key for the chosen provider (required when LLM_PROVIDER is set)
# LLM_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Model override (auto-selected per provider if empty)
#   OpenAI default: gpt-4o-mini
#   Anthropic default: claude-haiku
#   Gemini default: gemini-2.0-flash
# LLM_MODEL=

# Custom system prompt for summarization (optional, sensible default built-in)
# LLM_SUMMARY_PROMPT=

# Maximum tokens per day across all summarization calls (0 = unlimited)
LLM_DAILY_TOKEN_LIMIT=1000000

# -----------------------------------------------------------------------------
# Domain Filtering (Allow/Blocklists)
# -----------------------------------------------------------------------------
# Comma-separated regex patterns (Python re syntax, fullmatch).
# Blocklist checked first; then allowlist (empty = allow all).

# INBOUND_DOMAIN_ALLOWLIST=
# INBOUND_DOMAIN_BLOCKLIST=
# OUTBOUND_DOMAIN_ALLOWLIST=
# OUTBOUND_DOMAIN_BLOCKLIST=

# -----------------------------------------------------------------------------
# Global Send Rate Limiting
# -----------------------------------------------------------------------------
# Max outbound emails per rolling window (0 = unlimited).
# Both windows are enforced independently. HTTP 429 when exceeded.

# GLOBAL_SEND_RATE_LIMIT_PER_MINUTE=0
# GLOBAL_SEND_RATE_LIMIT_PER_HOUR=0

# -----------------------------------------------------------------------------
# Content Extraction (Verdandi)
# -----------------------------------------------------------------------------
# TALON_USE_ML_SIGNATURE=true
# MESSAGE_PREVIEW_MAX_LENGTH=100
# EXTRACTION_FALLBACK_TO_ORIGINAL=true

# -----------------------------------------------------------------------------
# Semantic Search
# -----------------------------------------------------------------------------
# OpenAI API key for generating embeddings
OPENAI_API_KEY=

# -----------------------------------------------------------------------------
# Webhooks (Outbound)
# -----------------------------------------------------------------------------
# Secret for signing webhook payloads
WEBHOOK_SECRET=

# Redis connection string (required for distributed rate limiting)
REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# MCP Server (Huginn & Muninn)
# -----------------------------------------------------------------------------
# MCP server host and port (for SSE/HTTP transports)
NORNWEAVE_MCP_HOST=0.0.0.0
NORNWEAVE_MCP_PORT=3000

# NornWeave API URL for MCP client (when MCP server connects to API)
NORNWEAVE_API_URL=http://localhost:8000
NORNWEAVE_API_KEY=
