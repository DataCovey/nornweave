# =============================================================================
# NornWeave Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# Never commit .env to version control!

# -----------------------------------------------------------------------------
# Storage Configuration (Ur√∞r - The Well)
# -----------------------------------------------------------------------------
# Database driver: postgres | sqlite
DB_DRIVER=postgres

# PostgreSQL connection string (production)
DATABASE_URL=postgresql+asyncpg://nornweave:nornweave@localhost:5432/nornweave

# SQLite path (local development only)
# DATABASE_URL=sqlite+aiosqlite:///./nornweave.db

# -----------------------------------------------------------------------------
# Email Provider Configuration (Yggdrasil - Provider Adapters)
# -----------------------------------------------------------------------------
# Provider: mailgun | ses | sendgrid | resend
EMAIL_PROVIDER=mailgun

# Default sender domain
EMAIL_DOMAIN=mail.example.com

# Mailgun Configuration
MAILGUN_API_KEY=
MAILGUN_DOMAIN=
MAILGUN_API_URL=https://api.mailgun.net

# AWS SES Configuration
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
# Optional: SES configuration set for tracking/analytics
AWS_SES_CONFIGURATION_SET=

# SendGrid Configuration
SENDGRID_API_KEY=
# ECDSA public key for webhook signature verification (from SendGrid security policy)
SENDGRID_WEBHOOK_PUBLIC_KEY=

# Resend Configuration
RESEND_API_KEY=
RESEND_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# API Security (Yggdrasil - Gateway)
# -----------------------------------------------------------------------------
# API key for authenticating requests (generate a secure random string)
API_KEY=

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# Host and port for the API server
HOST=0.0.0.0
PORT=8000

# Environment: development | staging | production
ENVIRONMENT=development

# Log level: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Attachment Storage Configuration
# -----------------------------------------------------------------------------
# Storage backend: local | database | s3 | gcs
NORNWEAVE_ATTACHMENT_STORAGE_BACKEND=local

# Local filesystem storage path (for local backend)
NORNWEAVE_ATTACHMENT_STORAGE_PATH=/var/nornweave/attachments

# Signed URL configuration (for local and database backends)
NORNWEAVE_ATTACHMENT_URL_EXPIRY=3600
# Secret for signing attachment URLs (auto-generated if not set)
# NORNWEAVE_ATTACHMENT_URL_SECRET=

# S3 Storage Configuration (requires nornweave[s3])
# Uses AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY from above
AWS_S3_BUCKET=nornweave-attachments
AWS_S3_REGION=us-east-1
# Optional: S3-compatible endpoint (MinIO, DigitalOcean Spaces, etc.)
# AWS_S3_ENDPOINT_URL=http://localhost:9000

# GCS Storage Configuration (requires nornweave[gcs])
GCS_BUCKET=nornweave-attachments
GCS_PROJECT=your-gcp-project-id
# Optional: explicit credentials path (uses ADC if not set)
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json

# -----------------------------------------------------------------------------
# LLM Thread Summarization (Verdandi - The Loom)
# -----------------------------------------------------------------------------
# Enable automatic thread summaries by setting a provider and API key.
# Disabled by default (LLM_PROVIDER not set).

# Provider: openai | anthropic | gemini (leave empty to disable)
# LLM_PROVIDER=openai

# API key for the chosen provider (required when LLM_PROVIDER is set)
# LLM_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Model override (auto-selected per provider if empty)
#   OpenAI default: gpt-4o-mini
#   Anthropic default: claude-haiku
#   Gemini default: gemini-2.0-flash
# LLM_MODEL=

# Custom system prompt for summarization (optional, sensible default built-in)
# LLM_SUMMARY_PROMPT=

# Maximum tokens per day across all summarization calls (0 = unlimited)
LLM_DAILY_TOKEN_LIMIT=1000000

# -----------------------------------------------------------------------------
# Phase 3: Semantic Search (Wisdom)
# -----------------------------------------------------------------------------
# OpenAI API key for generating embeddings
OPENAI_API_KEY=

# Embedding model
EMBEDDING_MODEL=text-embedding-3-small

# -----------------------------------------------------------------------------
# Phase 3: Rate Limiting (Skuld's Debt)
# -----------------------------------------------------------------------------
# Redis connection string (required for distributed rate limiting)
REDIS_URL=redis://localhost:6379/0

# Default rate limits
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_EMAILS_PER_MINUTE=10

# -----------------------------------------------------------------------------
# Phase 3: Webhooks (Outbound Prophecy)
# -----------------------------------------------------------------------------
# Secret for signing webhook payloads
WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# MCP Server (Huginn & Muninn)
# -----------------------------------------------------------------------------
# MCP server transport: stdio | sse | http
MCP_TRANSPORT=stdio

# MCP server host and port (for SSE/HTTP transports)
NORNWEAVE_MCP_HOST=0.0.0.0
NORNWEAVE_MCP_PORT=3000

# NornWeave API URL for MCP client (when MCP server connects to API)
NORNWEAVE_API_URL=http://localhost:8000
NORNWEAVE_API_KEY=
